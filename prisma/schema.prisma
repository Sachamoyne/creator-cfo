generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String       @id @default(cuid())
  email     String       @unique
  password  String?
  currency  String       @default("EUR")
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
  connections Connection[]
  transactions Transaction[]
}

model Connection {
  id           String        @id @default(cuid())
  userId       String
  provider     String
  status       String        @default("ACTIVE")
  accessToken  String?
  platformId  String?
  updatedAt    DateTime      @updatedAt
  user         User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  transactions Transaction[]

  @@unique([userId, provider])
}

model Transaction {
  id           String     @id @default(cuid())
  amount       Float
  description  String
  date         DateTime   @default(now())
  status       String     @default("COMPLETED")
  type         String     @default("INCOME")
  category     String?
  note         String?
  connectionId String?
  userId       String
  connection   Connection? @relation(fields: [connectionId], references: [id], onDelete: Cascade)
  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)
}

